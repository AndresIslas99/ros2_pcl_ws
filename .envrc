# --- Python venv con system-site-packages ---
export VIRTUAL_ENV_DISABLE_PROMPT=1
export PYTHONNOUSERSITE=1     # bloquea ~/.local, pero NO los del sistema

layout_python_with_system() {
  local py="${1:-python3}"
  local ver="$($py -c 'import sys;print(".".join(map(str, sys.version_info[:2])))')"
  local venv=".direnv/python-${ver}-sys"
  if [ ! -d "$venv" ]; then
    $py -m venv --system-site-packages "$venv"
  fi
  source "$venv/bin/activate"
}
layout_python_with_system

# --- Limpieza + underlay + overlay ROS (como ya lo ten√≠as) ---
unset ROS_VERSION ROS_DISTRO ROS_PYTHON_VERSION ROS_DOMAIN_ID ROS_LOCALHOST_ONLY
unset ROS_PACKAGE_PATH AMENT_PREFIX_PATH COLCON_PREFIX_PATH
source /opt/ros/humble/setup.bash
[ -f "$PWD/install/setup.bash" ] && source "$PWD/install/setup.bash"

echo "direnv: python=$(which python)  ROS=$ROS_DISTRO"
